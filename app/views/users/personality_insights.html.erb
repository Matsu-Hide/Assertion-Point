<style>
  #profile pre {
    max-height: 600px;
  }

  #sunburstChart svg {
    border: 1px solid black;
  }
</style>

<div class="modal-header">
  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
  <h4>
    全メッセージによる性格分析
  </h4>
</div>

<div class="modal-body">
  <div class="row">
    <div class="col-sm-4 col-xs-12">
      <div id="profile" data-profile="<%= @re %>"></div>
    </div>
    <div class="col-sm-8 col-xs-12">
      <div id="sunburstChart"></div>
    </div>
  </div>
</div>

<script type="text/javascript">
  var defaultColors = {
    traits_dark: '#5aaafa',
    traits_light: '#c0e6ff',
    facet: '#4178be',
    needs_dark: '#41d6c3',
    needs_light: '#a7fae6',
    need: '#008571',
    values_dark: '#ba8ff7',
    values_light: '#eed2ff',
    value: '#9855d4'
  };

  var options = {
    selector: '#sunburstChart',
    version: 'v3',
    d3version: 'v4',
    locale: 'ja',
    colors: defaultColors
  };

  var chart = new PersonalitySunburstChart(options);

  $(function() {
    var $profile = $('#profile');
    var re = $profile.data('profile');
    $profile.empty().append('<pre>' + JSON.stringify(re, null, 2) + '</pre>');
    chart.show(re, '<%= @user.image %>');
  });

</script>
